<ng-template #spanColumn let-refDate="refDate" let-group="group" let-userSchedule="userSchedule">
    <span
      (mousedown)="addActivity('start', userSchedule, group, refDate)"
      (mouseup)="addActivity('end',  userSchedule, group, refDate)"
      (mouseenter)="addActivity('enter', userSchedule, group, refDate)"
      [ngClass]="{ creating: creatingActivity.isCreating ? isInTheCreation(group, refDate) : false }"
    ></span>

</ng-template>

<ng-template #newActivityRow let-group="group" let-userSchedule="userSchedule">
  <ng-container *ngFor="let subColumn of subColumns">
    <ng-container
      *ngTemplateOutlet="spanColumn; context: { group, userSchedule, refDate:subColumn.lastSection.start }"
    ></ng-container>
    <ng-container
      *ngTemplateOutlet="spanColumn; context: { group, userSchedule, refDate:subColumn.lastSection.end }"
    ></ng-container>
    </ng-container>
</ng-template>

<ng-template #activitiesRow let-activities="activities">
      <section *ngFor="let activity of activities" class="activity" [ngStyle]="activityStyles(activity)" [innerHTML]="activityHTMLContent(activity)" >
      </section>
</ng-template>

<section class="user-groups" *ngFor="let userSchedule of content">
  <section *ngFor="let group of userSchedule.groups" class="group">
    <section class="row new-activity">
      <ng-container
        *ngTemplateOutlet="newActivityRow; context: { group, userSchedule }"
      ></ng-container>
    </section>

    <section class="row" *ngFor="let activities of filterActivities(group.groupedActivities)">
      <ng-container
        *ngTemplateOutlet="activitiesRow; context: { activities }"
      ></ng-container>
    </section>
  </section>
</section>
